<section class="auth-screen" [@authPageAnimation]>
  <app-auth-hero-panel />

  <div class="auth-pane">
    <article class="auth-card" [@staggerTextAnimation]>
      <p class="eyebrow reveal-item">{{ 'AUTH.REGISTER.EYEBROW' | translate }}</p>
      <h1 class="reveal-item">{{ 'AUTH.REGISTER.TITLE' | translate }}</h1>

      <form class="auth-form" [formGroup]="registerForm" (ngSubmit)="createAccount()" novalidate>
        <div class="field-group reveal-item">
          <label
            class="field-shell"
            [class.focused]="focusedField() === 'fullName'"
            [class.invalid]="hasError('fullName')"
            [class.has-value]="!!registerForm.controls.fullName.value"
          >
            <input
              type="text"
              formControlName="fullName"
              autocomplete="name"
              placeholder=" "
              (focus)="setFocusedField('fullName')"
              (blur)="setFocusedField(null)"
            />
            <span class="floating-label">{{ 'AUTH.REGISTER.FIELDS.FULL_NAME' | translate }}</span>
          </label>
          <p class="field-error" *ngIf="hasError('fullName')" [@fieldErrorAnimation]>
            {{ errorText('fullName') | translate }}
          </p>
        </div>

        <div class="field-group reveal-item">
          <label
            class="field-shell"
            [class.focused]="focusedField() === 'organization'"
            [class.invalid]="hasError('organization')"
            [class.has-value]="!!registerForm.controls.organization.value"
          >
            <input
              type="text"
              formControlName="organization"
              autocomplete="organization"
              placeholder=" "
              (focus)="setFocusedField('organization')"
              (blur)="setFocusedField(null)"
            />
            <span class="floating-label">{{ 'AUTH.REGISTER.FIELDS.ORGANIZATION' | translate }}</span>
          </label>
          <p class="field-error" *ngIf="hasError('organization')" [@fieldErrorAnimation]>
            {{ errorText('organization') | translate }}
          </p>
        </div>

        <div class="field-group reveal-item">
          <label
            class="field-shell"
            [class.focused]="focusedField() === 'email'"
            [class.invalid]="hasError('email')"
            [class.has-value]="!!registerForm.controls.email.value"
          >
            <input
              type="email"
              formControlName="email"
              autocomplete="email"
              placeholder=" "
              (focus)="setFocusedField('email')"
              (blur)="setFocusedField(null)"
            />
            <span class="floating-label">{{ 'AUTH.REGISTER.FIELDS.EMAIL' | translate }}</span>
          </label>
          <p class="field-error" *ngIf="hasError('email')" [@fieldErrorAnimation]>
            {{ errorText('email') | translate }}
          </p>
        </div>

        <div class="field-group reveal-item">
          <label
            class="field-shell"
            [class.focused]="focusedField() === 'password'"
            [class.invalid]="hasError('password')"
            [class.has-value]="!!registerForm.controls.password.value"
          >
            <input
              type="password"
              formControlName="password"
              autocomplete="new-password"
              placeholder=" "
              (focus)="setFocusedField('password')"
              (blur)="setFocusedField(null)"
            />
            <span class="floating-label">{{ 'AUTH.REGISTER.FIELDS.PASSWORD' | translate }}</span>
          </label>
          <p class="field-error" *ngIf="hasError('password')" [@fieldErrorAnimation]>
            {{ errorText('password') | translate }}
          </p>
        </div>

        <div class="field-group reveal-item">
          <label
            class="field-shell"
            [class.focused]="focusedField() === 'confirmPassword'"
            [class.invalid]="hasError('confirmPassword') || hasPasswordMismatch()"
            [class.has-value]="!!registerForm.controls.confirmPassword.value"
          >
            <input
              type="password"
              formControlName="confirmPassword"
              autocomplete="new-password"
              placeholder=" "
              (focus)="setFocusedField('confirmPassword')"
              (blur)="setFocusedField(null)"
            />
            <span class="floating-label">{{ 'AUTH.REGISTER.FIELDS.CONFIRM_PASSWORD' | translate }}</span>
          </label>
          <p
            class="field-error"
            *ngIf="hasError('confirmPassword') || hasPasswordMismatch()"
            [@fieldErrorAnimation]
          >
            {{ (hasPasswordMismatch() ? 'AUTH.REGISTER.ERRORS.PASSWORD_MISMATCH' : errorText('confirmPassword')) | translate }}
          </p>
        </div>

        <label class="terms-row reveal-item">
          <input type="checkbox" formControlName="acceptTerms" />
          <span>{{ 'AUTH.REGISTER.ACCEPT_TERMS' | translate }}</span>
        </label>
        <p class="field-error" *ngIf="hasTermsError()" [@fieldErrorAnimation]>
          {{ 'AUTH.REGISTER.ERRORS.TERMS_REQUIRED' | translate }}
        </p>

        <p class="form-error" *ngIf="errorMessage()" [@fieldErrorAnimation]>{{ errorMessage() | translate }}</p>

        <button type="submit" class="submit-btn reveal-item" [disabled]="isSubmitting()">
          {{ (isSubmitting() ? 'AUTH.REGISTER.SUBMITTING' : 'AUTH.REGISTER.SUBMIT') | translate }}
        </button>
      </form>

      <div class="auth-footer reveal-item">
        <p>
          {{ 'AUTH.REGISTER.ALREADY_HAVE_ACCESS' | translate }}
          <a routerLink="/auth/login">{{ 'AUTH.REGISTER.SIGN_IN' | translate }}</a>
        </p>
      </div>
    </article>
  </div>
</section>

<app-auth-modal
  *ngIf="showSuccessModal()"
  [title]="'AUTH.REGISTER.SUCCESS_MODAL.TITLE' | translate"
  [description]="'AUTH.REGISTER.SUCCESS_MODAL.DESCRIPTION' | translate"
  [primaryActionLabel]="'AUTH.REGISTER.SUCCESS_MODAL.PRIMARY_ACTION' | translate"
  (closed)="completeRegistration()"
  (primaryAction)="completeRegistration()"
>
  <p class="success-message">
    {{ 'AUTH.REGISTER.SUCCESS_MODAL.NOTE' | translate }}
  </p>
</app-auth-modal>
